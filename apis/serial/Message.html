<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.24">
    <title>Messages | Kambrik</title><meta name="description" content="A Kotlin Library Mod for Fabric">
    <link rel="modulepreload" href="/assets/app.6a3fb329.js"><link rel="modulepreload" href="/assets/Message.html.029c7bed.js"><link rel="modulepreload" href="/assets/Message.html.f48ac249.js">
    <link rel="stylesheet" href="/assets/style.d25eabc8.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/android-chrome-192x192.png" alt="Kambrik"><span class="site-name can-hide">Kambrik</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/main/Getting-Started" class="nav-link" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="APIs"><span class="title">APIs</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="APIs"><span class="title">APIs</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>DSLs</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/apis/dsl/Command" class="nav-link" aria-label="Command DSL"><!--[--><!--]--> Command DSL <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/apis/dsl/Text" class="nav-link" aria-label="Text Builder DSL"><!--[--><!--]--> Text Builder DSL <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Features</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/apis/feature/Registration" class="nav-link" aria-label="Registration API"><!--[--><!--]--> Registration API <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/apis/feature/Keybinds" class="nav-link" aria-label="Keybind API"><!--[--><!--]--> Keybind API <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Serialization</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/apis/serial/Serialization" class="nav-link" aria-label="Serialization API"><!--[--><!--]--> Serialization API <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/apis/serial/Message" class="nav-link router-link-active" aria-label="Message API"><!--[--><!--]--> Message API <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Experimental</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/apis/experimental/Serialization" class="nav-link" aria-label="NBT Serialization API"><!--[--><!--]--> NBT Serialization API <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/apis/experimental/Persistence" class="nav-link" aria-label="Persistence API"><!--[--><!--]--> Persistence API <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Mods"><span class="title">Mods</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Mods"><span class="title">Mods</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/mods/bountiful/" class="nav-link" aria-label="Bountiful"><!--[--><!--]--> Bountiful <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/ejektaflex/Kambrik/blob/master/CHANGELOG.md" rel="noopener noreferrer" target="_blank" aria-label="Changelog"><!--[--><!--]--> Changelog <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/ejektaflex/KambrikDocs/" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/main/Getting-Started" class="nav-link" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="APIs"><span class="title">APIs</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="APIs"><span class="title">APIs</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>DSLs</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/apis/dsl/Command" class="nav-link" aria-label="Command DSL"><!--[--><!--]--> Command DSL <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/apis/dsl/Text" class="nav-link" aria-label="Text Builder DSL"><!--[--><!--]--> Text Builder DSL <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Features</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/apis/feature/Registration" class="nav-link" aria-label="Registration API"><!--[--><!--]--> Registration API <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/apis/feature/Keybinds" class="nav-link" aria-label="Keybind API"><!--[--><!--]--> Keybind API <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Serialization</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/apis/serial/Serialization" class="nav-link" aria-label="Serialization API"><!--[--><!--]--> Serialization API <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/apis/serial/Message" class="nav-link router-link-active" aria-label="Message API"><!--[--><!--]--> Message API <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Experimental</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/apis/experimental/Serialization" class="nav-link" aria-label="NBT Serialization API"><!--[--><!--]--> NBT Serialization API <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/apis/experimental/Persistence" class="nav-link" aria-label="Persistence API"><!--[--><!--]--> Persistence API <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Mods"><span class="title">Mods</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Mods"><span class="title">Mods</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/mods/bountiful/" class="nav-link" aria-label="Bountiful"><!--[--><!--]--> Bountiful <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/ejektaflex/Kambrik/blob/master/CHANGELOG.md" rel="noopener noreferrer" target="_blank" aria-label="Changelog"><!--[--><!--]--> Changelog <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/ejektaflex/KambrikDocs/" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">Getting Started</p><ul class=""><li><!--[--><a href="/main/Getting-Started.html" class="nav-link sidebar-item" aria-label="Getting Started"><!--[--><!--]--> Getting Started <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/main/Philosophy.html" class="nav-link sidebar-item" aria-label="Design Philosophy"><!--[--><!--]--> Design Philosophy <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/main/Builtin-Commands.html" class="nav-link sidebar-item" aria-label="Built-in Commands"><!--[--><!--]--> Built-in Commands <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">DSLs</p><ul class=""><li><!--[--><a href="/apis/dsl/Command.html" class="nav-link sidebar-item" aria-label="Command DSL"><!--[--><!--]--> Command DSL <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/apis/dsl/Text.html" class="nav-link sidebar-item" aria-label="Text DSL"><!--[--><!--]--> Text DSL <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Features</p><ul class=""><li><!--[--><a href="/apis/feature/Registration.html" class="nav-link sidebar-item" aria-label="Auto Registration"><!--[--><!--]--> Auto Registration <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/apis/feature/Keybinds.html" class="nav-link sidebar-item" aria-label="Keybinding API"><!--[--><!--]--> Keybinding API <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item active">Serialization</p><ul class=""><li><!--[--><a href="/apis/serial/Serialization.html" class="nav-link sidebar-item" aria-label="Serialization"><!--[--><!--]--> Serialization <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/apis/serial/Message.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="Messages"><!--[--><!--]--> Messages <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/apis/serial/Message.html#message-basics" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Message Basics"><!--[--><!--]--> Message Basics <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/apis/serial/Message.html#serialization" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Serialization"><!--[--><!--]--> Serialization <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/apis/serial/Message.html#serializing-vanilla-classes" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Serializing Vanilla Classes"><!--[--><!--]--> Serializing Vanilla Classes <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/apis/serial/Message.html#reference-serializers" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Reference Serializers"><!--[--><!--]--> Reference Serializers <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/apis/serial/Message.html#usage-in-commands" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Usage in Commands"><!--[--><!--]--> Usage in Commands <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/apis/serial/Message.html#examples" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Examples"><!--[--><!--]--> Examples <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--[--><p class="sidebar-heading sidebar-item">Experimental APIs</p><ul class=""><li><!--[--><a href="/apis/experimental/Serialization.html" class="nav-link sidebar-item" aria-label="NBT Serialization (WIP)"><!--[--><!--]--> NBT Serialization (WIP) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/apis/experimental/Persistence.html" class="nav-link sidebar-item" aria-label="Data Persistence"><!--[--><!--]--> Data Persistence <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="messages" tabindex="-1"><a class="header-anchor" href="#messages" aria-hidden="true">#</a> Messages</h1><p>The Message API is an abstraction over the <a href="https://github.com/FabricMC/fabric/tree/1.17/fabric-networking-api-v1" target="_blank" rel="noopener noreferrer">Fabric Networking API<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>. It uses <a href="https://github.com/Kotlin/kotlinx.serialization" target="_blank" rel="noopener noreferrer">Kotlinx.Serialization<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> to send messages over the network, without needing to create a <code>NbtElement</code> or <code>PacketByteBuf</code>.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>This page assumes you have basic knowledge of <a href="https://github.com/Kotlin/kotlinx.serialization" target="_blank" rel="noopener noreferrer">Kotlinx Serialization<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>!</p></div><h2 id="message-basics" tabindex="-1"><a class="header-anchor" href="#message-basics" aria-hidden="true">#</a> Message Basics</h2><p>The Messages API allows us to send an object over the network, from the Client to the Server and vice-versa. To make a serializable object, it must have the <code>@Serializable</code> annotation and inherit from <code>ClientMsg</code> or <code>ServerMsg</code>.</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">import</span> io<span class="token punctuation">.</span>ejekta<span class="token punctuation">.</span>kambrik<span class="token punctuation">.</span>api<span class="token punctuation">.</span>message<span class="token punctuation">.</span>ClientMsg

<span class="token annotation builtin">@Serializable</span>
<span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">TestMsg</span><span class="token punctuation">(</span><span class="token keyword">val</span> num<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ClientMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onClientReceived</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> MsgContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Got num!: <span class="token interpolation variable">$num</span>&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Registration and usage of these messages is simple.</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">// Registration (one time, in onInitialize):</span>
Kambrik<span class="token punctuation">.</span>Messages<span class="token punctuation">.</span><span class="token function">registerClientMessage</span><span class="token punctuation">(</span>
	TestMsg<span class="token punctuation">.</span><span class="token function">serializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	<span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token string">&quot;my_mod&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test_msg&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">// Usage:</span>
<span class="token function">TestMsg</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendToClient</span><span class="token punctuation">(</span>some_player<span class="token punctuation">)</span>
<span class="token comment">// or</span>
<span class="token function">TestMsg</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendToClients</span><span class="token punctuation">(</span>some_players<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>NOTE: Every message class must have one and only one associated identifier.</p></div><h2 id="serialization" tabindex="-1"><a class="header-anchor" href="#serialization" aria-hidden="true">#</a> Serialization</h2><p>When creating a <code>ClientMsg</code>/<code>ServerMsg</code>, all class properties should be serializable. If they are not, they must be marked as <code>@Transient</code>.</p><h2 id="serializing-vanilla-classes" tabindex="-1"><a class="header-anchor" href="#serializing-vanilla-classes" aria-hidden="true">#</a> Serializing Vanilla Classes</h2><p>We can also serialize a limited selection of classes from Vanilla.</p><p>To do so, we mark the property/type with <code>@Contextual</code>:</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Serializable</span>
<span class="token keyword">class</span> <span class="token function">TellServerHello</span><span class="token punctuation">(</span><span class="token keyword">val</span> pos<span class="token operator">:</span> <span class="token annotation builtin">@Contextual</span> BlockPos<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ServerMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onServerReceived</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> MsgContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello from <span class="token interpolation variable">$pos</span>!&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>A list of all contextual classes <a href="https://github.com/ejektaflex/Kambrik/blob/master/src/main/java/io/ejekta/kambrik/api/serial/KambrikSerialApi.kt" target="_blank" rel="noopener noreferrer">can be found here<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</p><h2 id="reference-serializers" tabindex="-1"><a class="header-anchor" href="#reference-serializers" aria-hidden="true">#</a> Reference Serializers</h2><p>We can also reference some values that would otherwise be unserializable, and pass the reference to the other side. For example, <code>Item</code> classes are not serializable, but we can pass a reference to an Item registry object in a message.</p><p>Sending reference serializers works exactly like before, with a <code>@Contextual</code> annotation. In this example we send the server a Bucket:</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Serializable</span>
<span class="token keyword">class</span> <span class="token function">BanItem</span><span class="token punctuation">(</span><span class="token keyword">val</span> item<span class="token operator">:</span> <span class="token annotation builtin">@Contextual</span> Item<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ServerMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onServerReceived</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> MsgContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;We got passed a: <span class="token interpolation"><span class="token delimiter variable">${</span>item<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">asString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token delimiter variable">}</span></span>!&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//...</span>

<span class="token function">BanItem</span><span class="token punctuation">(</span>Items<span class="token punctuation">.</span>BUCKET<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendToServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>Obviously, this will cause incorrect behaviour if the bucket does not exist on the server side. Because of this, you should stick to using reference serializers only when you know the data exists on both sides.</p><p>A list of all reference serializers <a href="https://github.com/ejektaflex/Kambrik/blob/master/src/main/java/io/ejekta/kambrik/api/serial/KambrikSerialApi.kt" target="_blank" rel="noopener noreferrer">can be found here<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</p><h2 id="usage-in-commands" tabindex="-1"><a class="header-anchor" href="#usage-in-commands" aria-hidden="true">#</a> Usage in Commands</h2><p><code>ClientMsg</code> classes also have a <code>sendToClients</code> method. We can send this message to whichever players we&#39;d like! The Fabric Networking API has a helper class for this called <code>PlayerLookup</code>. The following example shows a message being sent to all players that are &#39;tracking&#39; (within view distance of) the world origin.</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token annotation builtin">@Serializable</span>
<span class="token keyword">class</span> PurgeArea <span class="token operator">:</span> <span class="token function">ClientMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onClientReceived</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> MsgContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		ctx<span class="token punctuation">.</span>client<span class="token punctuation">.</span>player<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">kill</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// later on, in a Command DSL:</span>
<span class="token string">&quot;purge&quot;</span> runs <span class="token punctuation">{</span>

	<span class="token function">PurgeArea</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendToClients</span><span class="token punctuation">(</span>
		PlayerLookup<span class="token punctuation">.</span><span class="token function">tracking</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span>source<span class="token punctuation">.</span>world<span class="token punctuation">,</span> BlockPos<span class="token punctuation">.</span>ORIGIN<span class="token punctuation">)</span>
	<span class="token punctuation">)</span>

	<span class="token number">1</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="examples" tabindex="-1"><a class="header-anchor" href="#examples" aria-hidden="true">#</a> Examples</h2><p>This example shows how the Messages API could save us a lot of code:</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Kambrik</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">Vanilla/Fabric</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">// Message Definition</span>
<span class="token annotation builtin">@Serializable</span>
<span class="token keyword">class</span> <span class="token function">PlaceItemAtPosition</span><span class="token punctuation">(</span>
    <span class="token keyword">val</span> item<span class="token operator">:</span> <span class="token annotation builtin">@Contextual</span> Item<span class="token punctuation">,</span> <span class="token keyword">val</span> amount<span class="token operator">:</span> Int<span class="token punctuation">,</span> <span class="token keyword">val</span> pos<span class="token operator">:</span> <span class="token annotation builtin">@Contextual</span> BlockPos
<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">ServerMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">onServerReceived</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> MsgContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// do placement here</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Register Message</span>
Kambrik<span class="token punctuation">.</span>Message<span class="token punctuation">.</span><span class="token function">registerServerMessage</span><span class="token punctuation">(</span>
	PlaceItemAtPosition<span class="token punctuation">.</span><span class="token function">serializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	<span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token string">&quot;kambrik&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;place_item&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token comment">// Send Message</span>
<span class="token function">PlaceItemAtPosition</span><span class="token punctuation">(</span>Items<span class="token punctuation">.</span>BUCKET<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> BlockPos<span class="token punctuation">.</span>ORIGIN<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sendToServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token comment">// Register packet</span>
ClientPlayNetworking<span class="token punctuation">.</span><span class="token function">registerGlobalReceiver</span><span class="token punctuation">(</span><span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token string">&quot;kambrik&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;place_item&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
	client<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> responseSender <span class="token operator">-&gt;</span>
		<span class="token keyword">val</span> itemStr <span class="token operator">=</span> buf<span class="token punctuation">.</span><span class="token function">readString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">val</span> item <span class="token operator">=</span> Registry<span class="token punctuation">.</span>ITEM<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token function">Identifier</span><span class="token punctuation">(</span>itemStr<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token keyword">val</span> amount <span class="token operator">=</span> buf<span class="token punctuation">.</span><span class="token function">readInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">val</span> pos <span class="token operator">=</span> buf<span class="token punctuation">.</span><span class="token function">readBlockPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		client<span class="token punctuation">.</span><span class="token function">execute</span> <span class="token punctuation">{</span>
			<span class="token comment">// do placement here</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Create packet</span>
<span class="token keyword">fun</span> <span class="token function">createPlacementPacket</span><span class="token punctuation">(</span>item<span class="token operator">:</span> Item<span class="token punctuation">,</span> amount<span class="token operator">:</span> Int<span class="token punctuation">,</span> pos<span class="token operator">:</span> BlockPos<span class="token punctuation">)</span><span class="token operator">:</span> PacketByteBuf <span class="token punctuation">{</span>
	<span class="token keyword">return</span> PacketByteBufs<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span> <span class="token punctuation">{</span>
		<span class="token function">writeString</span><span class="token punctuation">(</span>Registry<span class="token punctuation">.</span>ITEM<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token function">writeInt</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span>
		<span class="token function">writeBlockPos</span><span class="token punctuation">(</span>pos<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// Send packet</span>
ClientPlayNetworking<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>
	<span class="token function">Identifier</span><span class="token punctuation">(</span><span class="token string">&quot;kambrik&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;place_item&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	<span class="token function">createPlacementPacket</span><span class="token punctuation">(</span>Items<span class="token punctuation">.</span>BUCKET<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> BlockPos<span class="token punctuation">.</span>ORIGIN<span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><!--]--></div><!--]--></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/ejektaflex/KambrikDocs//edit/main/docs/apis/serial/Message.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">8/27/2021, 4:00:57 PM</span></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/apis/serial/Serialization.html" class="nav-link" aria-label="Serialization"><!--[--><!--]--> Serialization <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.6a3fb329.js" defer></script>
  </body>
</html>
